<svg id="mermaidInkSvg" width="100%" xmlns="http://www.w3.org/2000/svg" class="flowchart" style="max-width: 1016.2578125px;" viewBox="0 0 1016.2578125 1527.8125" role="graphics-document document" aria-roledescription="flowchart-v2" xmlns:xlink="http://www.w3.org/1999/xlink"><style xmlns="http://www.w3.org/1999/xhtml">@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css");</style><style>#mermaidInkSvg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaidInkSvg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaidInkSvg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaidInkSvg .error-icon{fill:#552222;}#mermaidInkSvg .error-text{fill:#552222;stroke:#552222;}#mermaidInkSvg .edge-thickness-normal{stroke-width:1px;}#mermaidInkSvg .edge-thickness-thick{stroke-width:3.5px;}#mermaidInkSvg .edge-pattern-solid{stroke-dasharray:0;}#mermaidInkSvg .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaidInkSvg .edge-pattern-dashed{stroke-dasharray:3;}#mermaidInkSvg .edge-pattern-dotted{stroke-dasharray:2;}#mermaidInkSvg .marker{fill:#333333;stroke:#333333;}#mermaidInkSvg .marker.cross{stroke:#333333;}#mermaidInkSvg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaidInkSvg p{margin:0;}#mermaidInkSvg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaidInkSvg .cluster-label text{fill:#333;}#mermaidInkSvg .cluster-label span{color:#333;}#mermaidInkSvg .cluster-label span p{background-color:transparent;}#mermaidInkSvg .label text,#mermaidInkSvg span{fill:#333;color:#333;}#mermaidInkSvg .node rect,#mermaidInkSvg .node circle,#mermaidInkSvg .node ellipse,#mermaidInkSvg .node polygon,#mermaidInkSvg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidInkSvg .rough-node .label text,#mermaidInkSvg .node .label text,#mermaidInkSvg .image-shape .label,#mermaidInkSvg .icon-shape .label{text-anchor:middle;}#mermaidInkSvg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaidInkSvg .rough-node .label,#mermaidInkSvg .node .label,#mermaidInkSvg .image-shape .label,#mermaidInkSvg .icon-shape .label{text-align:center;}#mermaidInkSvg .node.clickable{cursor:pointer;}#mermaidInkSvg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaidInkSvg .arrowheadPath{fill:#333333;}#mermaidInkSvg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaidInkSvg .flowchart-link{stroke:#333333;fill:none;}#mermaidInkSvg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaidInkSvg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaidInkSvg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaidInkSvg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaidInkSvg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidInkSvg .cluster text{fill:#333;}#mermaidInkSvg .cluster span{color:#333;}#mermaidInkSvg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidInkSvg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaidInkSvg rect.text{fill:none;stroke-width:0;}#mermaidInkSvg .icon-shape,#mermaidInkSvg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaidInkSvg .icon-shape p,#mermaidInkSvg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaidInkSvg .icon-shape rect,#mermaidInkSvg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaidInkSvg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaidInkSvg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaidInkSvg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaidInkSvg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaidInkSvg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaidInkSvg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaidInkSvg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="mermaidInkSvg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="mermaidInkSvg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M767.254,62L767.254,66.167C767.254,70.333,767.254,78.667,767.254,86.333C767.254,94,767.254,101,767.254,104.5L767.254,108" id="L_START_PROMPT_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_START_PROMPT_0" data-points="W3sieCI6NzY3LjI1MzkwNjI1LCJ5Ijo2Mn0seyJ4Ijo3NjcuMjUzOTA2MjUsInkiOjg3fSx7IngiOjc2Ny4yNTM5MDYyNSwieSI6MTEyfV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M687.449,147.434L618.746,154.695C550.043,161.956,412.637,176.478,343.934,187.239C275.23,198,275.23,205,275.23,208.5L275.23,212" id="L_PROMPT_ONPOL_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_PROMPT_ONPOL_0" data-points="W3sieCI6Njg3LjQ0OTIxODc1LCJ5IjoxNDcuNDM0MjM5OTg0NzU2ODN9LHsieCI6Mjc1LjIzMDQ2ODc1LCJ5IjoxOTF9LHsieCI6Mjc1LjIzMDQ2ODc1LCJ5IjoyMTZ9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M767.254,166L767.254,170.167C767.254,174.333,767.254,182.667,767.254,190.333C767.254,198,767.254,205,767.254,208.5L767.254,212" id="L_PROMPT_OFFPOL_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_PROMPT_OFFPOL_0" data-points="W3sieCI6NzY3LjI1MzkwNjI1LCJ5IjoxNjZ9LHsieCI6NzY3LjI1MzkwNjI1LCJ5IjoxOTF9LHsieCI6NzY3LjI1MzkwNjI1LCJ5IjoyMTZ9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M174.973,287.984L159.26,293.153C143.547,298.323,112.121,308.661,96.408,317.331C80.695,326,80.695,333,80.695,336.5L80.695,340" id="L_ONPOL_R1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_ONPOL_R1_0" data-points="W3sieCI6MTc0Ljk3MjY1NjI1LCJ5IjoyODcuOTgzNzU1MzQ2Mjc4Mn0seyJ4Ijo4MC42OTUzMTI1LCJ5IjozMTl9LHsieCI6ODAuNjk1MzEyNSwieSI6MzQ0fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M275.752,294L275.807,298.167C275.863,302.333,275.975,310.667,276.03,318.333C276.086,326,276.086,333,276.086,336.5L276.086,340" id="L_ONPOL_R2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_ONPOL_R2_0" data-points="W3sieCI6Mjc1Ljc1MTc3MDAxOTUzMTI1LCJ5IjoyOTR9LHsieCI6Mjc2LjA4NTkzNzUsInkiOjMxOX0seyJ4IjoyNzYuMDg1OTM3NSwieSI6MzQ0fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M375.488,287.696L391.486,292.913C407.484,298.131,439.48,308.565,455.479,317.283C471.477,326,471.477,333,471.477,336.5L471.477,340" id="L_ONPOL_R3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_ONPOL_R3_0" data-points="W3sieCI6Mzc1LjQ4ODI4MTI1LCJ5IjoyODcuNjk2MTkyMjAxMjc3OX0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6MzE5fSx7IngiOjQ3MS40NzY1NjI1LCJ5IjozNDR9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M707.161,294L700.741,298.167C694.321,302.333,681.481,310.667,675.061,318.333C668.641,326,668.641,333,668.641,336.5L668.641,340" id="L_OFFPOL_T1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_OFFPOL_T1_0" data-points="W3sieCI6NzA3LjE2MTQzNzk4ODI4MTIsInkiOjI5NH0seyJ4Ijo2NjguNjQwNjI1LCJ5IjozMTl9LHsieCI6NjY4LjY0MDYyNSwieSI6MzQ0fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M828.389,294L834.921,298.167C841.452,302.333,854.515,310.667,861.047,318.333C867.578,326,867.578,333,867.578,336.5L867.578,340" id="L_OFFPOL_T2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_OFFPOL_T2_0" data-points="W3sieCI6ODI4LjM4ODk3NzA1MDc4MTIsInkiOjI5NH0seyJ4Ijo4NjcuNTc4MTI1LCJ5IjozMTl9LHsieCI6ODY3LjU3ODEyNSwieSI6MzQ0fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M80.695,422L80.695,426.167C80.695,430.333,80.695,438.667,130.787,452.575C180.879,466.484,281.062,485.968,331.154,495.71L381.245,505.452" id="L_R1_MIXER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R1_MIXER_0" data-points="W3sieCI6ODAuNjk1MzEyNSwieSI6NDIyfSx7IngiOjgwLjY5NTMxMjUsInkiOjQ0N30seyJ4IjozODUuMTcxODc1LCJ5Ijo1MDYuMjE1MjczODkwNDQzOH1d" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M276.086,422L276.086,426.167C276.086,430.333,276.086,438.667,293.646,449.663C311.205,460.66,346.325,474.32,363.884,481.15L381.444,487.981" id="L_R2_MIXER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R2_MIXER_0" data-points="W3sieCI6Mjc2LjA4NTkzNzUsInkiOjQyMn0seyJ4IjoyNzYuMDg1OTM3NSwieSI6NDQ3fSx7IngiOjM4NS4xNzE4NzUsInkiOjQ4OS40MzA1NDc3ODA4ODc2NX1d" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,422L471.477,426.167C471.477,430.333,471.477,438.667,471.477,446.333C471.477,454,471.477,461,471.477,464.5L471.477,468" id="L_R3_MIXER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R3_MIXER_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjQyMn0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6NDQ3fSx7IngiOjQ3MS40NzY1NjI1LCJ5Ijo0NzJ9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M668.641,422L668.641,426.167C668.641,430.333,668.641,438.667,650.786,449.716C632.932,460.765,597.223,474.529,579.368,481.412L561.514,488.294" id="L_T1_MIXER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_T1_MIXER_0" data-points="W3sieCI6NjY4LjY0MDYyNSwieSI6NDIyfSx7IngiOjY2OC42NDA2MjUsInkiOjQ0N30seyJ4Ijo1NTcuNzgxMjUsInkiOjQ4OS43MzI0OTU5Mzg1MDN9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M867.578,422L867.578,426.167C867.578,430.333,867.578,438.667,816.6,452.614C765.622,466.562,663.666,486.125,612.688,495.906L561.71,505.687" id="L_T2_MIXER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_T2_MIXER_0" data-points="W3sieCI6ODY3LjU3ODEyNSwieSI6NDIyfSx7IngiOjg2Ny41NzgxMjUsInkiOjQ0N30seyJ4Ijo1NTcuNzgxMjUsInkiOjUwNi40NDA3MjEwOTAzMTM4fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,574L471.477,578.167C471.477,582.333,471.477,590.667,471.477,598.333C471.477,606,471.477,613,471.477,616.5L471.477,620" id="L_MIXER_BATCH_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_MIXER_BATCH_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjU3NH0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6NTk5fSx7IngiOjQ3MS40NzY1NjI1LCJ5Ijo2MjR9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,678L471.477,684.167C471.477,690.333,471.477,702.667,471.477,714.333C471.477,726,471.477,737,471.477,742.5L471.477,748" id="L_BATCH_GRPO_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_BATCH_GRPO_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjY3OH0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6NzE1fSx7IngiOjQ3MS40NzY1NjI1LCJ5Ijo3NTJ9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,830L471.477,834.167C471.477,838.333,471.477,846.667,471.477,854.333C471.477,862,471.477,869,471.477,872.5L471.477,876" id="L_GRPO_KL_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_GRPO_KL_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjgzMH0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6ODU1fSx7IngiOjQ3MS40NzY1NjI1LCJ5Ijo4ODB9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,958L471.477,962.167C471.477,966.333,471.477,974.667,471.477,982.333C471.477,990,471.477,997,471.477,1000.5L471.477,1004" id="L_KL_UPDATE_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_KL_UPDATE_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjk1OH0seyJ4Ijo0NzEuNDc2NTYyNSwieSI6OTgzfSx7IngiOjQ3MS40NzY1NjI1LCJ5IjoxMDA4fV0=" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,1062L471.477,1066.167C471.477,1070.333,471.477,1078.667,471.477,1086.333C471.477,1094,471.477,1101,471.477,1104.5L471.477,1108" id="L_UPDATE_EXBUF_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_UPDATE_EXBUF_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjEwNjJ9LHsieCI6NDcxLjQ3NjU2MjUsInkiOjEwODd9LHsieCI6NDcxLjQ3NjU2MjUsInkiOjExMTJ9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M471.477,1190L471.477,1194.167C471.477,1198.333,471.477,1206.667,507.981,1222.812C544.484,1238.957,617.492,1262.913,653.996,1274.892L690.5,1286.87" id="L_EXBUF_CHECK_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_EXBUF_CHECK_0" data-points="W3sieCI6NDcxLjQ3NjU2MjUsInkiOjExOTB9LHsieCI6NDcxLjQ3NjU2MjUsInkiOjEyMTV9LHsieCI6Njk0LjMwMDgwMzIxNDk5NzEsInkiOjEyODguMTE3MTY1NTM1MDAyOX1d" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M789.696,1287.278L823.947,1275.232C858.198,1263.185,926.701,1239.093,960.952,1216.38C995.203,1193.667,995.203,1172.333,995.203,1151C995.203,1129.667,995.203,1108.333,995.203,1089C995.203,1069.667,995.203,1052.333,995.203,1035C995.203,1017.667,995.203,1000.333,995.203,981C995.203,961.667,995.203,940.333,995.203,919C995.203,897.667,995.203,876.333,995.203,855C995.203,833.667,995.203,812.333,995.203,789C995.203,765.667,995.203,740.333,995.203,717C995.203,693.667,995.203,672.333,995.203,653C995.203,633.667,995.203,616.333,995.203,595C995.203,573.667,995.203,548.333,995.203,523C995.203,497.667,995.203,472.333,995.203,449C995.203,425.667,995.203,404.333,995.203,383C995.203,361.667,995.203,340.333,995.203,319C995.203,297.667,995.203,276.333,995.203,255C995.203,233.667,995.203,212.333,971.162,196.182C947.122,180.032,899.04,169.063,874.999,163.579L850.958,158.095" id="L_CHECK_PROMPT_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_CHECK_PROMPT_0" data-points="W3sieCI6Nzg5LjY5NjE1OTIzNDQ5MjQsInkiOjEyODcuMjc4MTkwNDg0NDkyNH0seyJ4Ijo5OTUuMjAzMTI1LCJ5IjoxMjE1fSx7IngiOjk5NS4yMDMxMjUsInkiOjExNTF9LHsieCI6OTk1LjIwMzEyNSwieSI6MTA4N30seyJ4Ijo5OTUuMjAzMTI1LCJ5IjoxMDM1fSx7IngiOjk5NS4yMDMxMjUsInkiOjk4M30seyJ4Ijo5OTUuMjAzMTI1LCJ5Ijo5MTl9LHsieCI6OTk1LjIwMzEyNSwieSI6ODU1fSx7IngiOjk5NS4yMDMxMjUsInkiOjc5MX0seyJ4Ijo5OTUuMjAzMTI1LCJ5Ijo3MTV9LHsieCI6OTk1LjIwMzEyNSwieSI6NjUxfSx7IngiOjk5NS4yMDMxMjUsInkiOjU5OX0seyJ4Ijo5OTUuMjAzMTI1LCJ5Ijo1MjN9LHsieCI6OTk1LjIwMzEyNSwieSI6NDQ3fSx7IngiOjk5NS4yMDMxMjUsInkiOjM4M30seyJ4Ijo5OTUuMjAzMTI1LCJ5IjozMTl9LHsieCI6OTk1LjIwMzEyNSwieSI6MjU1fSx7IngiOjk5NS4yMDMxMjUsInkiOjE5MX0seyJ4Ijo4NDcuMDU4NTkzNzUsInkiOjE1Ny4yMDUxMjM4MTExNTU4Nn1d" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/><path d="M742.418,1367.813L742.418,1373.979C742.418,1380.146,742.418,1392.479,742.418,1404.146C742.418,1415.813,742.418,1426.813,742.418,1432.313L742.418,1437.813" id="L_CHECK_END_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_CHECK_END_0" data-points="W3sieCI6NzQyLjQxNzk2ODc1LCJ5IjoxMzY3LjgxMjV9LHsieCI6NzQyLjQxNzk2ODc1LCJ5IjoxNDA0LjgxMjV9LHsieCI6NzQyLjQxNzk2ODc1LCJ5IjoxNDQxLjgxMjV9XQ==" marker-end="url(#mermaidInkSvg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_START_PROMPT_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_PROMPT_ONPOL_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_PROMPT_OFFPOL_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_ONPOL_R1_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_ONPOL_R2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_ONPOL_R3_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_OFFPOL_T1_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_OFFPOL_T2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R1_MIXER_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R2_MIXER_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R3_MIXER_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_T1_MIXER_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_T2_MIXER_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_MIXER_BATCH_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_BATCH_GRPO_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_GRPO_KL_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_KL_UPDATE_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_UPDATE_EXBUF_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_EXBUF_CHECK_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(995.203125, 715)"><g class="label" data-id="L_CHECK_PROMPT_0" transform="translate(-13.0546875, -12)"><foreignObject width="26.109375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Yes</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(742.41796875, 1404.8125)"><g class="label" data-id="L_CHECK_END_0" transform="translate(-10.2265625, -12)"><foreignObject width="20.453125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>No</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-START-0" transform="translate(767.25390625, 35)"><rect class="basic label-container" style="fill:#00b894 !important;stroke:#00cec9 !important" x="-77.578125" y="-27" width="155.15625" height="54"/><g class="label" style="color:#fff !important" transform="translate(-47.578125, -12)"><rect/><foreignObject width="95.15625" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>Start Training</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-PROMPT-1" transform="translate(767.25390625, 139)"><rect class="basic label-container" style="" x="-79.8046875" y="-27" width="159.609375" height="54"/><g class="label" style="" transform="translate(-49.8046875, -12)"><rect/><foreignObject width="99.609375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Input Prompts</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-ONPOL-3" transform="translate(275.23046875, 255)"><rect class="basic label-container" style="" x="-100.2578125" y="-39" width="200.515625" height="78"/><g class="label" style="" transform="translate(-70.2578125, -24)"><rect/><foreignObject width="140.515625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Generate On-Policy<br />(temperature &gt; 0)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-OFFPOL-5" transform="translate(767.25390625, 255)"><rect class="basic label-container" style="" x="-110.78125" y="-39" width="221.5625" height="78"/><g class="label" style="" transform="translate(-80.78125, -24)"><rect/><foreignObject width="161.5625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Load Off-Policy Traces<br />(DeepSeek-R1)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-R1-7" transform="translate(80.6953125, 383)"><rect class="basic label-container" style="" x="-72.6953125" y="-39" width="145.390625" height="78"/><g class="label" style="" transform="translate(-42.6953125, -24)"><rect/><foreignObject width="85.390625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Response 1<br />reward: 0.6</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-R2-9" transform="translate(276.0859375, 383)"><rect class="basic label-container" style="" x="-72.6953125" y="-39" width="145.390625" height="78"/><g class="label" style="" transform="translate(-42.6953125, -24)"><rect/><foreignObject width="85.390625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Response 2<br />reward: 0.8</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-R3-11" transform="translate(471.4765625, 383)"><rect class="basic label-container" style="" x="-72.6953125" y="-39" width="145.390625" height="78"/><g class="label" style="" transform="translate(-42.6953125, -24)"><rect/><foreignObject width="85.390625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Response 3<br />reward: 0.4</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-T1-13" transform="translate(668.640625, 383)"><rect class="basic label-container" style="" x="-74.46875" y="-39" width="148.9375" height="78"/><g class="label" style="" transform="translate(-44.46875, -24)"><rect/><foreignObject width="88.9375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>R1 Trace 1<br />reward: 0.95</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-T2-15" transform="translate(867.578125, 383)"><rect class="basic label-container" style="" x="-74.46875" y="-39" width="148.9375" height="78"/><g class="label" style="" transform="translate(-44.46875, -24)"><rect/><foreignObject width="88.9375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>R1 Trace 2<br />reward: 0.88</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-MIXER-17" transform="translate(471.4765625, 523)"><rect class="basic label-container" style="fill:#e17055 !important;stroke:#d63031 !important" x="-86.3046875" y="-51" width="172.609375" height="102"/><g class="label" style="color:#fff !important" transform="translate(-56.3046875, -36)"><rect/><foreignObject width="112.609375" height="72"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>Off-Policy Mixer<br />on_weight: 0.5<br />off_weight: 0.5</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-BATCH-27" transform="translate(471.4765625, 651)"><rect class="basic label-container" style="" x="-74.0234375" y="-27" width="148.046875" height="54"/><g class="label" style="" transform="translate(-44.0234375, -12)"><rect/><foreignObject width="88.046875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Mixed Batch</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-GRPO-29" transform="translate(471.4765625, 791)"><rect class="basic label-container" style="fill:#6c5ce7 !important;stroke:#a29bfe !important" x="-112.4921875" y="-39" width="224.984375" height="78"/><g class="label" style="color:#fff !important" transform="translate(-82.4921875, -24)"><rect/><foreignObject width="164.984375" height="48"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>GRPO Loss<br />+ Importance Sampling</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-KL-31" transform="translate(471.4765625, 919)"><rect class="basic label-container" style="" x="-106.4765625" y="-39" width="212.953125" height="78"/><g class="label" style="" transform="translate(-76.4765625, -24)"><rect/><foreignObject width="152.953125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>KL Penalty<br />(vs Reference Model)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-UPDATE-33" transform="translate(471.4765625, 1035)"><rect class="basic label-container" style="" x="-79.359375" y="-27" width="158.71875" height="54"/><g class="label" style="" transform="translate(-49.359375, -12)"><rect/><foreignObject width="98.71875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Update Policy</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-EXBUF-35" transform="translate(471.4765625, 1151)"><rect class="basic label-container" style="fill:#fdcb6e !important;stroke:#f39c12 !important" x="-93.4453125" y="-39" width="186.890625" height="78"/><g class="label" style="color:#000 !important" transform="translate(-63.4453125, -24)"><rect/><foreignObject width="126.890625" height="48"><div style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#000 !important" class="nodeLabel"><p>Add to ExGRPO<br />Experience Buffer</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-CHECK-37" transform="translate(742.41796875, 1303.90625)"><polygon points="63.90625,0 127.8125,-63.90625 63.90625,-127.8125 0,-63.90625" class="label-container" transform="translate(-63.40625, 63.90625)"/><g class="label" style="" transform="translate(-24.90625, -24)"><rect/><foreignObject width="49.8125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>More<br />Steps?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-END-41" transform="translate(742.41796875, 1480.8125)"><rect class="basic label-container" style="fill:#00b894 !important;stroke:#00cec9 !important" x="-92.265625" y="-39" width="184.53125" height="78"/><g class="label" style="color:#fff !important" transform="translate(-62.265625, -24)"><rect/><foreignObject width="124.53125" height="48"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>Improved<br />Reasoning Model</p></span></div></foreignObject></g></g></g></g></g></svg>